<% totals_week_number = 6 %>
<% final_week_number = 7 %>

<fieldset>

	<legend><%= t 'activerecord.models.service_datum.other' %><span class="admin-only"> (<%= week.service_data[0].id.to_s + ',' + week.service_data[1].id.to_s %>)</span></legend>

	<% if index >= 0 and index <= final_week_number %>

	<!-- Service ids -->
	<input type="hidden" value="<%= week.service_data[0].id %>" name="product_and_service_datum[product_and_service_weeks_attributes][<%= index %>][service_data_attributes][0][id]" id="product_and_service_datum_product_and_service_weeks_attributes_<%= index %>_service_data_attributes_0_id">

	<input type="hidden" value="<%= week.service_data[1].id %>" name="product_and_service_datum[product_and_service_weeks_attributes][<%= index %>][service_data_attributes][1][id]" id="product_and_service_datum_product_and_service_weeks_attributes_<%= index %>_service_data_attributes_1_id">

	<!-- Service types -->
	<input type="hidden" value="attendance" name="product_and_service_datum[product_and_service_weeks_attributes][<%= index %>][service_data_attributes][0][service_type]" id="product_and_service_datum_product_and_service_weeks_attributes_<%= index %>_service_data_attributes_0_service_type">

	<input type="hidden" value="return" name="product_and_service_datum[product_and_service_weeks_attributes][<%= index %>][service_data_attributes][1][service_type]" id="product_and_service_datum_product_and_service_weeks_attributes_<%= index %>_service_data_attributes_1_service_type">

	<% end %>

	<!-- Service header row -->
	<table class="input-table">
		<thead>
			<tr>
				<th scope="col" class="col-md-6"></th>
				<th scope="col" class="col-md-2">
					<span class="label"><%= t 'helpers.prod_and_serv_datum.checkup' %></span>
				</th>
				<th scope="col" class="col-md-2">
					<span class="label"><%= t 'helpers.prod_and_serv_datum.return' %></span>
				</th>
				<th scope="col" class="col-md-2">
					<span class="label"><%= t 'helpers.total' %></span>
				</th>
			</tr>
		</thead>				

			<% service_row = 0 %>

			<!-- Service body rows -->
			<% ServiceData.services.each do |name| %>

			<tr class="service-<%= index %>-row">
				<th scope="row" class="col-md-6">
					<span class="label"><%= t('activerecord.attributes.service_datum.' + name) %></span>
				</th>
				<td class="col-md-2">
					<% if index != -1 %>
					<%= text_field_tag 'product_and_service_datum[product_and_service_weeks_attributes][' + index.to_s + '][service_data_attributes][0][' + name +']', week.service_data[0].instance_eval(name), class: 'form-control ' + name + ' attendance attendance_week_' + index.to_s + ' week_' + index.to_s + ' numbers_only service_input service_checkup input-sm service_row_' + service_row.to_s + '_col_0' + (index >= totals_week_number-1 ? ' extra_tab temp_field' : ' '), readonly: fields_readonly?(week) %>

					<% else %>
					<%= text_field_tag 'product_and_service_week[service_data_attributes][0][' + name +']', week.service_data[0].instance_eval(name), class: 'form-control ' + name + ' week_' + index.to_s + ' attendance service_week_' + index.to_s + ' numbers_only service_input service_checkup input-sm service_row_' + service_row.to_s + '_col_0' + (index >= totals_week_number ? ' extra_tab temp_field' : ' '), disabled: index == totals_week_number-1 %>
					<% end %>
				</td>
				<td class="col-md-2">
					<% if index != -1 %>

					<%= text_field_tag 'product_and_service_datum[product_and_service_weeks_attributes][' + index.to_s + '][service_data_attributes][1][' + name +']', week.service_data[1].instance_eval(name), class: 'form-control ' + name + ' return return_week_' + index.to_s + ' service_input numbers_only service_return input-sm service_row_' + service_row.to_s + '_col_1 week_' + index.to_s + (index >= totals_week_number-1 ? ' extra_tab temp_field' : ' '), readonly: fields_readonly?(week) %>

					<% else %>
					<%= text_field_tag 'product_and_service_week[service_data_attributes][1][' + name +']', week.service_data[1].instance_eval(name), class: 'form-control ' + name + ' week_' + index.to_s + ' attendance attendance_week_' + index.to_s + ' numbers_only service_input service_checkup input-sm service_row_' + service_row.to_s + '_col_1' + (index >= totals_week_number ? ' extra_tab temp_field' : ' '), disabled: index >= totals_week_number-1 %>
					<% end %>
				</td>
				<td class="col-md-2">
					<%= text_field_tag name, '', id: 'week_' + week.number.to_s + '_service_' + name + '_total', class: 'form-control input-sm service_total temp_field week_' + index.to_s, readonly: true, disabled: true %>
				</td>
			</tr>

			<% service_row += 1 %>

			<% end %>

		<!-- Service totals row -->
		<tfoot>
			<tr>
				<th scope="row" class="col-md-6">
					<span class="label"><%= t 'helpers.total' %></span>
				</th>
				<td class="col-md-2">
					<%= text_field_tag 'total_service_checkup', 0, id: 'total_service_checkup_week_' + index.to_s, class: 'form-control input-sm temp_field', readonly: true, disabled: true %>
				</td>
				<td class="col-md-2">
					<%= text_field_tag 'total_service_return', 0, id: 'total_service_return_week_' + index.to_s, class: 'form-control input-sm temp_field', readonly: true, disabled: true %>
				</td>
				<td class="col-md-2">
					<%= text_field_tag 'total_service', 0, id: 'total_service_week_' + index.to_s, class: 'form-control input-sm temp_field', readonly: true, disabled: true %>
				</td>
			</tr>
		</tfoot>
	</table>
</fieldset>